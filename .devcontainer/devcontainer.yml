# Codespaces configuration for webapp-ui (Vite React frontend) and webapp-server (Python backend)

version: 0.2.0

# Use the official Node.js 20 image
image:
  name: mcr.microsoft.com/devcontainers/node:20

features:
  - ghcr.io/devcontainers/features/node:1
  - ghcr.io/devcontainers/features/python:1

# Set up ports
forwardPorts:
  - 5173
  - 8000 # Python backend default port

# Run the frontend automatically
postCreateCommand: |
  cd webapp-ui
  npm install
  npm run build
  cd ../webapp-server
  pip install --upgrade pip
  pip install -r requirements.txt

tasks:
  - name: Start Vite Preview
    command: npm run preview -- --host 0.0.0.0
    cwd: webapp-ui
    isBackground: true
  - name: Start Python Backend
    command: python app.py
    cwd: webapp-server
    isBackground: true

# Set the default workspace folder
workspaceFolder: /workspaces/webapp
